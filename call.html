<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">

    <!-- viewport meta -->
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">

    <!-- font awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome-animation/0.2.1/font-awesome-animation.min.css" type="text/css" media="all" />

    <title>電話アプリ</title>

    <style>
      html{
        touch-action:manipulation;

        user-select:none;
        -moz-user-select:none;
        -webkit-user-select:none;
        -ms-user-select:none;
      }


      .screen{
        width:768px;
        /*height:800px;*/
        position:absolute;
        top:0;
        left:0;
        display:;
      }
      #initial-screen{
        background:white;
      }


      .input-number-container{
        height:250px;
        width:100%;
        position:relative;
        overflow:hidden;
      }
      #initial-input-number-container{
        height:250px;
        width:100%;
        position:relative;
        overflow:hidden;
      }
      .input-number{
        position:absolute;
        display:block;
        width:100%;
        top:100px;
        /*
        top:50%;
        -ms-transform: translateY(-50%);
        -webkit-transform : translateY(-50%);
        transform : translateY(-50%);
        */
        text-align:center;
        font-size:50px;
      }
      



      .flex-container{
        display:flex;
        flex-flow:row wrap;
        justify-content:flex-start;
        align-content:space-around;
        width:60%;
        /*height:650px;*/
        margin:auto;
      }
      #initial-flex-container{
        height:650px;
      }
      .flex-content{
        flex-basis:33.3%;
        height:110px;
        position:relative;
      }
      .b{
        position:absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%,-50%);
        -webkit-transform : translate(-50%,-50%);
        transform : translate(-50%,-50%);

        height:105px;
        width:105px;
        border-radius:50%;
        background:#EEEEEE;
        font-weight:400;
        font-size:45px;
        line-height:105px;

        border:none;
      }
      .b:active{
        background:#999999;
      }
      #callButton{
        background:rgb(59,234,88);
        color:white;
      }
      #callButton:active{
        background:rgb(30, 119, 45);
        color:#7c7c7c;
      }
      #deleteButton{
        border-radius:0px;
        height:40px;
        width:60px;
        border-radius:0 10px 10px 0;
        clip-path: polygon(33% 0%, 100% 0%, 100% 100%, 33% 100%, 0% 50%);

        line-height:40px;
        font-size:25px;

        display:none;
      }
      #deleteButton>span{
        position:absolute;
        top:0px;
        left:30px;
        font-weight:600;
      }



      #calling-screen{
        background:black;
        text-align:center;

        background:#535353;
        color:white;
        display:none;
      }
      #calling-input-number-container{
        
      }

      #message{
        position:absolute;
        display:block;
        width:100%;
        top:180px;
        
        text-align:center;
        font-size:25px;
      }

      #calling-flex-container{
        height:500px;
      }

      #calling-screen .b{
        background:#646464;
        color:white;
      }
      #calling-screen .b:active{
        background:#838383;
      }
      #calling-screen .b:disabled{
        background:#646464;
        color:#797979;
      }
      #calling-screen>span{
        vertical-align:middle;
        font-size:30px;
      }
      #cancel-calling{
        background:rgb(214, 0, 0) !important;
      }



      #keypad-screen{
        display:none;
      }
    </style>

  </head>
  <body>

    <!-- 最初の画面 -->
    <div id="initial-screen" class="screen">
      <div id="initial-input-number-container" class="initial-input-number">
        <span class="input-number"></span>
      </div>
      <div class="flex-container" id="initial-flex-container">
        <div class="flex-content">
          <button class="b" onclick="tap1()">1</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap2()">2</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap3()">3</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap4()">4</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap5()">5</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap6()">6</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap7()">7</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap8()">8</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap9()">9</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tapA()">＊</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap0()">0</button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tapS()">#</button>
        </div>
        <div class="flex-content">
        </div>
        <div class="flex-content">
          <button id="callButton" class="b" onclick="tapCall()"><i class="fas fa-phone fa-flip-horizontal"></i></button>
        </div>
        <div class="flex-content">
          <button id="deleteButton" class="b" onclick="tapDelete()"><span><i class="fas fa-times"></i></span></button>
        </div>
      </div>
    </div>

    <!-- 通話中の画面 -->
    <div id="calling-screen" class="screen">
      <div class="input-number-container" id="calling-input-number-container">
        <span class="input-number"></span>
        <span id="message">calling...</span>
      </div>
      <div class="flex-container" id="calling-flex-container">
        <div class="flex-content">
          <button class="b" disabled><i class="fas fa-microphone-slash"></i></button>
        </div>
        <div class="flex-content">
          <button id="key" class="b" onclick="tapKey()"disabled><i class="fas fa-th"></i></button>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="fas fa-volume-up"></i></button>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="fas fa-plus"></i></button>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="fas fa-video"></i></button>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="fas fa-user"></i></button>
        </div>
        <div class="flex-content">
        </div>
        <div class="flex-content">
            <button class="b" id="cancel-calling"onclick="cancelCalling()"><i class="fas fa-phone-slash"></i></button>
        </div>
        <div class="flex-content">
        </div>
      </div>
    </div>

    <!-- 通話中にkeypadを開いた画面 -->
    <div id="keypad-screen" class="screen">
        <div class="input-number-container" id="keypad-input-number-container">
          <span class="input-number"></span>
          <span id="message">calling...</span>
        </div>
        <div class="flex-container" id="keypad-flex-container">
          <div class="flex-content">
            <button class="b" onclick="tap1()">1</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap2()">2</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap3()">3</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap4()">4</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap5()">5</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap6()">6</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap7()">7</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap8()">8</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap9()">9</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tapA()">＊</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap0()">0</button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tapS()">#</button>
          </div>
          <div class="flex-content">
          </div>
          <div class="flex-content">
            <button id="callButton" class="b" onclick="tapCall()"><i class="fas fa-phone fa-flip-horizontal"></i></button>
          </div>
          <div class="flex-content">
            <button id="deleteButton" class="b" onclick="tapDelete()"><span><i class="fas fa-times"></i></span></button>
          </div>
        </div>
      </div>


    <script>

      // 打ち込まれた番号(String)
      var number="";

      // deleteボタン(最初は非表示)
      var deleteButton = document.getElementById("deleteButton");

      //音楽再生のためのオブジェクト
      var audio;
      var audio119 = new Audio();
      var audioF = new Audio();
      var audioL = new Audio();
      audio119.src = "ima.m4a";
      audioF.src = "former.m4a";
      audioL.src = "latter.m4a";

      //引数に true もしくは false を指定して delete ボタンの表示を切り替える
      function showDeleteButton(show){
        if(show){
          deleteButton.style.display = "inline-block";
        }else{
          deleteButton.style.display = "none"
        }
      }

      // ユーザーが打ち込んだ番号を表示する(同時に delete ボタンの表示非表示を切り替える)
      function reflectNumber(){
        var input_number_class = document.getElementsByClassName("input-number");
        var i = input_number_class.length;
        while(--i>=0){
          input_number_class[i].textContent = number;
        }
        if(number != ""){
          showDeleteButton(true);
        }else{
          showDeleteButton(false);
        }
      }

      //call ボタンが押されたときの処理
      function tapCall(){
        if(number=="119"){
          calling_screen = document.getElementById("calling-screen");
          calling_screen.style.display = "block";
          
          audio = audio119;
          audio.play();
        }else if(number=="***"){
          calling_screen = document.getElementById("calling-screen");
          calling_screen.style.display = "block";

          var key = document.getElementById("key");
          var key_icon = key.children[0];
          key_icon.classList.add("faa-flash");
          key_icon.classList.add("animated");
          key.removeAttribute("disabled");

          audio = audioF;
          audio.play();
        }else{
          alert("電話番号が違います");
          number = "";
          reflectNumber()
        }
      }

      //通話画面を閉じる
      function cancelCalling(){
        audio.pause();
        audio.currentTime = 0;
        calling_screen = document.getElementById("calling-screen");
        calling_screen.style.display = "none";
        number = "";
        reflectNumber();
      }

      //keypad ボタンを押す
      function tapKey(){
        number = "";
        reflectNumber();
        var keypad_screen = document.getElementById("keypad-screen");
        keypad_screen.style.display = "block";
        
      }



      function tap1(){
        number = number+1;
        reflectNumber();
      }
      function tap2(){
        number = number+2;
        reflectNumber();
      }
      function tap3(){
        number = number+3;
        reflectNumber();
      }
      function tap4(){
        number = number+4;
        reflectNumber();
      }
      function tap5(){
        number = number+5;
        reflectNumber();
      }
      function tap6(){
        number = number+6;
        reflectNumber();
      }
      function tap7(){
        number = number+7;
        reflectNumber();
      }
      function tap8(){
        number = number+8;
        reflectNumber();
      }
      function tap9(){
        number = number+9;
        reflectNumber();
      }
      function tap0(){
        number = number+0;
        reflectNumber();
      }
      function tapA(){
        number = number + "*";
        reflectNumber();
      }
      function tapS(){
        number = number + "#";
        reflectNumber();
      }
      function tapDelete(){
        number = number.slice(0,-1);;
        reflectNumber();
      }
    </script>
      
  </body>
</html>