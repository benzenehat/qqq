<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">

    <!-- viewport meta -->
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">

    <!-- font awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome-animation/0.2.1/font-awesome-animation.min.css" type="text/css" media="all" />

    <!-- google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">

    <title>電話アプリ</title>

    <style>
      html{
        touch-action:manipulation;

        user-select:none;
        -moz-user-select:none;
        -webkit-user-select:none;
        -ms-user-select:none;

        font-family: 'Roboto', sans-serif;
      }


      .screen{
        width:768px;
        /*height:800px;*/
        position:absolute;
        top:0;
        left:0;

        text-align:center;

        display:;
      }
      #initial-screen{
        background:white;
      }


      .input-number-container{
        height:200px;
        width:100%;
        position:relative;
        overflow:hidden;
      }
      #initial-input-number-container{
        height:200px;
        width:100%;
        position:relative;
        overflow:hidden;
      }
      .input-number{
        position:absolute;
        display:block;
        width:100%;
        /*top:100px;*?
        /*
        top:50%;
        -ms-transform: translateY(-50%);
        -webkit-transform : translateY(-50%);
        transform : translateY(-50%);
        */
        line-height:200px;
        text-align:center;
        font-size:50px;
      }
      



      .flex-container{
        display:flex;
        flex-flow:row wrap;
        justify-content:flex-start;
        align-content:space-around;
        width:60%;
        /*height:650px;*/
        margin:auto;
      }
      #initial-flex-container{
        height:650px;
      }
      .flex-content{
        flex-basis:33.3%;
        height:110px;
        position:relative;
      }
      .b{
        position:absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%,-50%);
        -webkit-transform : translate(-50%,-50%);
        transform : translate(-50%,-50%);

        height:105px;
        width:105px;
        border-radius:50%;
        background:#EEEEEE;
        font-weight:400;
        font-size:45px;
        line-height:105px;

        -webkit-appearance:none;

        border:none;
      }
      .b:active{
        background:#999999;
      }
      .button-content{
        position:absolute;
        right:0;
        left:0;
        top:30px;
        line-height:45px;
      }
      #callButton{
        background:rgb(59,234,88);
        color:white;
      }
      #callButton:active{
        background:rgb(30, 119, 45);
        color:#7c7c7c;
      }
      .deleteButton{
        border-radius:0px;
        height:40px;
        width:60px;
        border-radius:0 10px 10px 0;
        clip-path: polygon(33% 0%, 100% 0%, 100% 100%, 33% 100%, 0% 50%);
        -webkit-clip-path: polygon(33% 0%, 100% 0%, 100% 100%, 33% 100%, 0% 50%);

        line-height:40px;
        font-size:25px;

        display:none;
      }
      .deleteButton>span{
        position:absolute;
        top:0px;
        left:30px;
        font-weight:600;
      }



      #calling-screen{

        background:#535353;
        color:white;
        display:none;
      }
      #calling-input-number-container{
        
      }

      #message{
        position:absolute;
        display:block;
        width:100%;
        top:150px;
        
        text-align:center;
        font-size:25px;
      }

      #calling-flex-container{
        height:500px;
        margin-top:50px;
      }

      #calling-screen .b{
        background:#646464;
        color:white;
      }
      #calling-screen .b:active{
        background:#838383;
      }
      #calling-screen .b:disabled{
        background:#646464;
        color:#797979;
      }
      #calling-screen .b:disabled + span{
        color:#797979;
      }
      #calling-flex-container>.flex-content>span{
        position: absolute;
        top: 110px;
        left:0;
        width:100%;
        text-align: center;

        font-size:20px;
      }
      #calling-screen>span{
        vertical-align:middle;
        font-size:30px;
      }
      .cancel-calling{
        color:white !important;
        background:rgb(214, 0, 0) !important;
      }
      .cancel-calling:active{
        background:rgb(153, 0, 0) !important;
        color:#7c7c7c !important;
      }



      #keypad-screen{
        display:none;
        color:white;
        background:#535353;
      }
      #keypad-flex-container{
        height:650px;
      }

      #keypad-screen .b{
        background:#646464;
        color:white;
      }
      #keypad-screen .b:active{
        background:#838383;
      }
      #keypad-flex-container>.flex-content>span{
        position: absolute;
        top: 110px;
        left:0;
        width:100%;
        text-align: center;

        font-size:20px;
      }
    </style>

  </head>
  <body>

    <!-- 最初の画面 -->
    <div id="initial-screen" class="screen">
      <div id="initial-input-number-container" class="initial-input-number">
        <span class="input-number"></span>
      </div>
      <div class="flex-container" id="initial-flex-container">
        <div class="flex-content">
          <button class="b" onclick="tap1()"><span class="button-content">1</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap2()"><span class="button-content">2</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap3()"><span class="button-content">3</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap4()"><span class="button-content">4</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap5()"><span class="button-content">5</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap6()"><span class="button-content">6</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap7()"><span class="button-content">7</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap8()"><span class="button-content">8</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap9()"><span class="button-content">9</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tapA()"><span class="button-content">＊</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tap0()"><span class="button-content">0</span></button>
        </div>
        <div class="flex-content">
          <button class="b" onclick="tapS()"><span class="button-content">#</span></button>
        </div>
        <div class="flex-content">
        </div>
        <div class="flex-content">
          <button id="callButton" class="b" onclick="tapCall()"><i class="button-content fas fa-phone fa-flip-horizontal"></i></button>
        </div>
        <div class="flex-content">
          <button class="b deleteButton" onclick="tapDelete()"><span><i class="fas fa-times"></i></span></button>
        </div>
      </div>
    </div>

    <!-- 通話中の画面 -->
    <div id="calling-screen" class="screen">
      <div class="input-number-container" id="calling-input-number-container">
        <span class="input-number">119</span>
        <span id="message">calling...</span>
      </div>
      <div class="flex-container" id="calling-flex-container">
        <div class="flex-content">
          <button class="b" disabled><i class="button-content fas fa-microphone-slash"></i></button>
          <span>mute</span>
        </div>
        <div class="flex-content">
          <button id="key" class="b" onclick="tapKey()"disabled><i class="button-content fas fa-th faa-flash"></i></button>
          <span>keypad</span>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="button-content fas fa-volume-up"></i></button>
          <span>speaker</span>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="button-content fas fa-plus"></i></button>
          <span>add call</span>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="button-content fas fa-video"></i></button>
          <span>FaceTime</span>
        </div>
        <div class="flex-content">
          <button class="b" disabled><i class="button-content fas fa-user"></i></button>
          <span>contacts</span>
        </div>
        <div class="flex-content">
        </div>
        <div class="flex-content">
            <button class="b cancel-calling" onclick="cancelCalling()"><i class="button-content fas fa-phone-slash"></i></button>
        </div>
        <div class="flex-content">
        </div>
      </div>
    </div>

    <!-- 通話中にkeypadを開いた画面 -->
    <div id="keypad-screen" class="screen">
        <div class="input-number-container" id="keypad-input-number-container">
          <span class="input-number"></span>
          <span id="message">Enter Password...</span>
        </div>
        <div class="flex-container" id="keypad-flex-container">
          <div class="flex-content">
            <button class="b" onclick="tap1()"><span class="button-content">1</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap2()"><span class="button-content">2</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap3()"><span class="button-content">3</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap4()"><span class="button-content">4</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap5()"><span class="button-content">5</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap6()"><span class="button-content">6</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap7()"><span class="button-content">7</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap8()"><span class="button-content">8</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap9()"><span class="button-content">3</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tapA()"><span class="button-content">＊</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tap0()"><span class="button-content">0</span></button>
          </div>
          <div class="flex-content">
            <button class="b" onclick="tapS()"><span class="button-content">#</span></button>
          </div>
          <div class="flex-content">
          </div>
          <div class="flex-content">
              <button class="b cancel-calling" onclick="cancelCalling()"><i class="button-content fas fa-phone-slash"></i></button>
          </div>
          <div class="flex-content">
            <button class="b deleteButton" onclick="tapDelete()"><span><i class="button-content fas fa-times"></i></span></button>
          </div>
        </div>
      </div>


    <script>

      // 打ち込まれた番号(String)
      var number="";

      // deleteボタン(最初は非表示)
      var deleteButtons = Array.from(document.getElementsByClassName("deleteButton"));

      // screen element
      var initial_screen = document.getElementById("initial-screen");
      var calling_screen = document.getElementById("calling-screen");
      var keypad_screen = document.getElementById("keypad-screen");
      var screens = [initial_screen, calling_screen, keypad_screen];

      // screen に対応した background
      var backgrounds = ["white", "#535353", "#535353"]

      //音楽再生のためのオブジェクト
      var audio;
      var audio119 = new Audio();
      var audioF = new Audio();
      var audioL = new Audio();
      audio119.src = "ima.m4a";
      audioF.src = "former.m4a";
      audioL.src = "latter.m4a";



      //引数に true もしくは false を指定して delete ボタンの表示を切り替える
      function showDeleteButton(show){
        var display;
        if(show){
          display = "inline-block";
        }else{
          display = "none";
        }
        
        deleteButtons.forEach(function(deleteButton){
          deleteButton.style.display = display;
        })
        
      }

      // ユーザーが打ち込んだ番号を表示する(同時に delete ボタンの表示非表示を切り替える)
      function reflectNumber(){
        var input_number_class = document.getElementsByClassName("input-number");
        var i = input_number_class.length;
        while(--i>=0){
          input_number_class[i].textContent = number;
        }
        if(number != ""){
          showDeleteButton(true);
        }else{
          showDeleteButton(false);
        }
      }

      //screenの切り替え
      function transitScreen(element){
        var i = screens.length;
        while(--i>=0){
          if(screens[i]==element){
            screens[i].style.display = "block";
            document.body.style.background = backgrounds[i];
          }else{
            screens[i].style.display = "none";
          }
        }
      }

      //call ボタンが押されたときの処理
      function tapCall(){
        if(number=="119"){
          var key = document.getElementById("key");
          var key_icon = key.children[0];
          if(key_icon.classList.contains("animated")){
            key_icon.classList.remove("animated");
            key.setAttribute("disabled", "");
          }

          transitScreen(calling_screen);
          
          audio = audio119;
          audio.play();
        }else if(number=="***"){
          transitScreen(calling_screen);

          var key = document.getElementById("key");
          var key_icon = key.children[0];
          key_icon.classList.add("animated");
          key.removeAttribute("disabled");

          audio = audioF;
          audio.play();
        }else{
          alert("電話番号が違います");
          number = "";
          reflectNumber()
        }
      }

      // 再生を止めて巻き戻す
      function stopAudio(audio){
        audio.pause();
        audio.currentTime = 0;
      }

      //通話画面を閉じる
      function cancelCalling(){
        stopAudio(audio);
        transitScreen(initial_screen);
        number = "";
        reflectNumber();
      }

      //keypad ボタンを押す
      function tapKey(){

        number = "";
        reflectNumber();
        
        transitScreen(keypad_screen);
        
      }


      function tap1(){
        number = number+1;
        reflectNumber();
      }
      function tap2(){
        number = number+2;
        reflectNumber();
        
        if(audio==audioF&&number==302){
          stopAudio(audio);
          audio=audioL;
          audioL.play();
        }
      }
      function tap3(){
        number = number+3;
        reflectNumber();
      }
      function tap4(){
        number = number+4;
        reflectNumber();
      }
      function tap5(){
        number = number+5;
        reflectNumber();
      }
      function tap6(){
        number = number+6;
        reflectNumber();
      }
      function tap7(){
        number = number+7;
        reflectNumber();
      }
      function tap8(){
        number = number+8;
        reflectNumber();
      }
      function tap9(){
        number = number+9;
        reflectNumber();
      }
      function tap0(){
        number = number+0;
        reflectNumber();
      }
      function tapA(){
        number = number + "*";
        reflectNumber();
      }
      function tapS(){
        number = number + "#";
        reflectNumber();
      }
      function tapDelete(){
        number = number.slice(0,-1);;
        reflectNumber();
      }

      // function launchFullscreen(element) {
      //   if(element.requestFullscreen) {
      //     element.requestFullscreen();
      //   } else if(element.mozRequestFullScreen) {
      //     element.mozRequestFullScreen();
      //   } else if(element.webkitRequestFullscreen) {
      //     element.webkitRequestFullscreen();
      //   } else if(element.msRequestFullscreen) {
      //     element.msRequestFullscreen();
      // }
      // }

    </script>
      
  </body>
</html>